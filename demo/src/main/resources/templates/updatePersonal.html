<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8"/>
<title>personal</title>
<link rel="stylesheet" type="text/css" th:href="@{/css/navigation.css}" />
<link rel="stylesheet" type="text/css" th:href="@{/css/base.css}" />
<style type="text/css">
.personalMessage{
	border-style:solid;
	height:300px;
	width:400px;
	margin:0 auto;
}
.navigationDiv{
	float:left;
}
.userImage{
	width:140px;
}
.bodys{
	margin:30px;
	padding:30px;
	border-style:solid;
	height:500px;
}
.personalFormDiv{
	margin-top: 30px;
	margin-left:56px;
	width:240px;
}

.formText{
	padding-right:30px;
} 
#upPersonalBut{
	margin-top: 10px;
	margin-left: 113px;
}
</style>
</head>
<body>
	<h1 id="message">今天真是个好天气!!!</h1>
	<div class="bodys">
		<div class="navigationDiv" th:fragment="personalNavigation">
			<ul>
				<li class="userLi">
					<a id="updateImage"
						th:href="@{personal/showPersonal}">修改头像</a></li>
				<li><a id="updatePersonal"
						th:href="@{personal/updatePersonal}">修改资料</a></li>
				<li><a id="updatePassword"
						th:href="@{personal/updatePassword}">修改密码</a></li>
			</ul>
		</div>
		<div class="personalMessage" th:object="${session.user}">
			<div class="personalFormDiv">
				<form action="#" id="updateForm">
					<span class="formText">姓名</span>
					<input type="text" id="userName" name="userName" th:value="*{userName}"/><br/>
					<span class="formText">性别</span>
					<input type="radio" id="sex1" name="sex" value="1"/>
					<label for="sex1">男</label>
					<input type="radio" id="sex0" name="sex" value="0"/>
					<label for="sex0">女</label>
					<input type="radio" id="sex-1" name="sex" value="-1" checked="checked"/>
					<label for="sex-1">保密</label><br/>
					<span class="formText">手机</span>
					<input type="text" name="phone" th:value="*{phone}"/><br/>
					<span class="formText">邮箱</span>
					<input type="text" name="email" th:value="*{email}"/><br/>
					<span class="formText">生日</span>
					<input type="text" name="birthday" class="demo-input" 
						placeholder="出生日期" id="test30" th:value="*{birthday}"/><br/>
					<input type="button" id="upPersonalBut" value="修改" />
				</form>
			</div>
		</div>
	</div>
</body>
<script th:src="@{/js/jquery-1.10.2.min.js}" type="text/javascript"></script>
<!-- 自定义日期选择器 -->
<script th:src="@{/laydate/laydate.js}"></script>
<script type="text/javascript" th:inline="javascript">
	/* 检查用户名是否存在 */
	$("#userName").blur(function(){
		$.ajax({
			url:[[@{checkUserName}]],
			data:"userName="+$("#userName").val(),
			type:"get",
			dataType:"json",
			success:function(obj){
				if(obj.state == 0){
					$("#upPersonalBut").removeAttr("disabled");
				}else{
					$("#upPersonalBut").attr("disabled","disabled");
				}
					$("#message").html(obj.message);
			}
		});
	})
		
	$("#upPersonalBut").click(function(){
		$.ajax({
			url:[[@{updatePersonal}]],
			data:$("#updateForm").serialize(),
			type:"post",
			dataType:"json",
			success:function(obj){
				if(obj.state==0){
					location=[[@{/}]];
					}
				$("#message").html(obj.message);
			}
		});
	});
	
</script>
<script>
    lay('#version').html('-v'+ laydate.v);

    //执行一个laydate实例
    //自定义颜色
    laydate.render({
      elem: '#test30'
      ,theme: '#393D49'
    });

</script>
</html>